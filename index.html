<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LiteGraph Factory Simulator – Standalone</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/litegraph.js/0.7.13/css/litegraph.min.css" integrity="sha512-cW9ZCxqs9VK2Ae7bg9Gb4WTRkOFpOmGYkdwV0hNvZpBcS7WccWsv6oElVCycB1Bw1Eu5Jdg7Heh6dV6nHkeS5g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
  <header id="controls" aria-label="シミュレーション操作">
    <button id="btnStart" type="button">Start</button>
    <button id="btnStop" type="button">Stop</button>
    <button id="btnReset" type="button">Reset</button>
    <label>
      Speed ×
      <input type="number" id="speedInput" value="1" min="0.1" max="100" step="0.1" aria-label="シミュレーション速度" />
    </label>
    <span>Time: <span id="simTime">0.00 s</span></span>
    <select id="exampleSelect" title="レイアウト例を読み込み">
      <option value="">例を読み込み…</option>
      <option value="simple">シンプル(直列)</option>
      <option value="branch">分岐(スプリット)</option>
      <option value="buffer">バッファ付き</option>
    </select>
  </header>

  <section id="fileControls" aria-label="ファイル操作">
    <button id="btnSave" type="button">Save</button>
    <button id="btnLoad" type="button">Load</button>
    <button id="btnAuto" type="button">Autosave: <span id="autoState">OFF</span></button>
    <input type="file" id="fileInput" accept=".json" />
  </section>

  <main>
    <canvas id="graph" role="application" aria-label="ファクトリーシミュレーター"></canvas>
  </main>

  <aside id="hud" aria-live="polite">
    <div>Throughput (all Sinks): <span id="tp">0</span></div>
    <div>WIP (in flight): <span id="wip">0</span></div>
    <div>Last Work: <span id="lastWork">-</span></div>
  </aside>

  <aside id="inspector" hidden>
    <h3>ノード編集</h3>
    <div class="row">
      <label for="inspTitle">Title</label>
      <input id="inspTitle" type="text" />
    </div>
    <div id="inspProps"></div>
    <div class="btns">
      <button id="btnOpenScript" type="button" title="スクリプトエディタ">Script…</button>
      <button id="btnApply" type="button">適用</button>
    </div>
  </aside>

  <section id="scriptEditorModal" role="dialog" aria-modal="true" aria-labelledby="scriptNodeTitle">
    <div id="scriptEditorContainer">
      <div id="scriptHeader"><span id="scriptNodeTitle">Script Editor</span></div>
      <textarea id="scriptEditorTextarea"></textarea>
      <div id="scriptEditorControls">
        <button id="scriptEditorSave" type="button">Save</button>
        <button id="scriptEditorCancel" type="button">Cancel</button>
      </div>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/litegraph.js/0.7.13/build/litegraph.min.js" integrity="sha512-EVbWcv16O3MHuvb6jVWeItPxX2VINeodIZ6hO6PvxI6Bfq5lHppZArYrusS4x+h0/pk3jfbQfVIAtF+wNCz7Lw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="module" src="assets/js/app.js"></script>
</body>
</html>
